# Facebook自动化广告规则需求

## 需求背景

投放自动化一期即将完成，批量创建工具的应用会产生大量广告，而这部分广告的维护需要依赖Facebook 广告规则的API。

运营这边总结了一套投放规则，需要一个后端同学转换成代码上传到Facebook规则库。

因为目前总结的规则并没有经过实际检验，所以需要这周实际检验一下在投放中的效果。



## 相关数据

### 1.广告数量与展示量的关系

取值范围：6月1日-8月1日的白牌投放数据

样本量：8个广告账号，3898个广告

impression：当天所有广告所拿到的展示量之和

广告数量：当天处于激活状态的广告数量

![广告数量与展示的关系](/Users/lee/OneDrive - inc/CM/需求/facebook投放自动化/投放自动化需求文档/投放自动化需求文档/img/广告数量与展示的关系.png)



- 结论：**广告数量和展示量有强关联**



### 2.单个广告展示量

将展示量分为十个区间，下图是上述的3898个广告在所在区间的占比。

![image-20180809131451289](/var/folders/zk/zty1bxjx2ss2580krbb4n2s40000gp/T/abnerworks.Typora/image-20180809131451289.png)

- **70%的广告展示量都在3000以下**
这部分的广告使用自动化规则来管理，将节约大量人力成本

  

## 判断逻辑

**判断impression --> 判断install --> 判断CPI --> 判断CTR -->判断CVR**



## 流程图

![Untitled Diagram (3)](/Users/lee/Downloads/Untitled Diagram (3).png)

## 广告规则API介绍

广告规则是在广告规则库中创建和存储的独立对象，至少包含一个 `name`、一个 `evaluation_spec` 和一个 `execution_spec`。规则的基本架构如下所示：

```
curl \
-F 'name=Rule 1' \
-F 'evaluation_spec={
    ...
   }' \
-F 'execution_spec={
    ...
   }' \
-F "access_token=<ACCESS_TOKEN>" \
https://graph.facebook.com/<VERSION>/<AD_ACCOUNT_ID>/adrules_library
```

Facebook 会在成效分析指标或对象元数据字段出现变化时评估实时触发规则，根据设置的时间间隔评估定期触发规则。



## 评估参数

规则的 `evaluation_spec` 的主要目的是确定规则执行操作的对象。`evaluation_type` 用于确定评估方法的类型，包含下列选项：

| 评估类型   | 说明         |
| ---------- | ------------ |
| `SCHEDULE` | 定期触发规则 |
| `TRIGGER`  | 实时触发规则 |



这次需要上传的，除了止损规则是实时触发规则，其他的都是定期触发规则。







# 广告规则判断值

规则中大部分的值，都是根据历史投放数据计算出来的。



## 数据样本量

| 时间    | 账号数量 | campaign数量 | adset数量 | ad数量 |
| ------- | -------- | ------------ | --------- | ------ |
| 6.1-8.5 | 8        | 202          | 1192      | 3885   |
| 8.1-8.5 | 6        | 90           | 329       | 845    |



### 分国家impression值

将使用历史数据计算出的30%线作为起量与否的判断值。

| 国家 | active广告数量 | avg_impression | 30%线 | 6月1日起总展示数 |
| ---- | -------------- | -------------- | ----- | ---------------- |
| IN   | 1507           | 31848          | 1699  | 47994560         |
| US   | 1096           | 16492          | 9224  | 18074687         |
| ID   | 1164           | 11247          | 2101  | 13091679         |
| BR   | 985            | 11547          | 2272  | 11373648         |
| AR   | 957            | 7187           | 1107  | 6877568          |
| EG   | 1277           | 4002           | 4361  | 5110756          |
| HK   | 662            | 6990           | 2248  | 4627120          |
| DZ   | 1124           | 4025           | 1651  | 4524335          |
| SG   | 708            | 6271           | 2930  | 4439852          |
| PR   | 652            | 6431           | 7236  | 4192717          |
| VN   | 728            | 5270           | 376   | 3836715          |
| GB   | 688            | 5327           | 1867  | 3664997          |
| DE   | 673            | 4574           | 1536  | 3078571          |
| TW   | 669            | 4465           | 2431  | 2986993          |

